(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Goods"],{"3db2":function(e,t,n){"use strict";n("7a6e")},"7a6e":function(e,t,n){},"7e6c":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("7db0");var c=n("4360"),a=function(e){var t=c["a"].state.goodClassify.find((function(t){return t._id===e}));return t&&t.title||"未知分类"}},de6d:function(e,t,n){"use strict";n.r(t);var c=n("7a23"),a=Object(c["Y"])("data-v-464bc92e");Object(c["G"])("data-v-464bc92e");var r={key:0},u={class:"search"},o=Object(c["m"])(" 添加一条 "),i=Object(c["m"])("   "),l=Object(c["m"])("上传 Excel 添加"),s=Object(c["m"])("   "),d=Object(c["m"])("   ");Object(c["E"])();var b=a((function(e,t,n,b,O,j){var f=Object(c["L"])("a-divider"),p=Object(c["L"])("a-input-search"),v=Object(c["L"])("a-button"),m=Object(c["L"])("a-upload"),h=Object(c["L"])("space-between"),g=Object(c["L"])("a-table"),_=Object(c["L"])("a-pagination"),w=Object(c["L"])("flex-end"),y=Object(c["L"])("a-card"),D=Object(c["L"])("add-one"),k=Object(c["L"])("update"),C=Object(c["M"])("only-admin");return Object(c["D"])(),Object(c["j"])("div",null,[Object(c["n"])(y,{title:e.simple?e.$$.PAGE_META.DASHBOARD.RECENT.LEFT_TITLE:""},{default:a((function(){return[e.simple?Object(c["k"])("",!0):(Object(c["D"])(),Object(c["j"])("div",r,[Object(c["n"])("h2",null,Object(c["O"])(e.$$.PAGE_META.TOPIC_MGR.PAGE_TITLE),1),Object(c["n"])(f),Object(c["n"])(h,null,{default:a((function(){return[Object(c["n"])("div",u,[Object(c["n"])(p,{placeholder:"根据".concat(e.$$.KEYWORD,"搜索"),"enter-button":"",value:e.keyword,"onUpdate:value":t[1]||(t[1]=function(t){return e.keyword=t}),onSearch:e.onSearch},null,8,["placeholder","value","onSearch"]),e.isSearch?(Object(c["D"])(),Object(c["j"])("a",{key:0,href:"javascript:;",onClick:t[2]||(t[2]=function(){return e.backAll&&e.backAll.apply(e,arguments)})},"返回")):Object(c["k"])("",!0)]),Object(c["n"])("div",null,[Object(c["X"])(Object(c["n"])(v,{onClick:t[3]||(t[3]=function(t){return e.show=!0})},{default:a((function(){return[o]})),_:1},512),[[C]]),i,Object(c["n"])(m,{onChange:e.onUploadChange,action:"http://localhost:3000/upload/file",headers:e.headers},{default:a((function(){return[Object(c["n"])(v,{type:"primary"},{default:a((function(){return[l]})),_:1})]})),_:1},8,["onChange","headers"])])]})),_:1}),Object(c["n"])(f)])),Object(c["n"])(g,{columns:e.columns,"data-source":e.list,pagination:!1,bordered:"",scroll:{x:"max-content"}},Object(c["l"])({producedDate:a((function(t){return[Object(c["m"])(Object(c["O"])(e.formatTimestamp(t.record.producedDate)),1)]})),classify:a((function(t){var n=t.record;return[Object(c["m"])(Object(c["O"])(e.getClassifyTitleById(n.classify)),1)]})),count:a((function(t){return[Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.updateCount("IN_COUNT",t.record)}},"入库",8,["onClick"]),Object(c["m"])(" "+Object(c["O"])(t.record.count)+" ",1),Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.updateCount("OUT_COUNT",t.record)}},"出库",8,["onClick"])]})),_:2},[e.simple?void 0:{name:"actions",fn:a((function(t){return[Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.toDetail(t)}},"详情",8,["onClick"]),s,Object(c["X"])(Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.update(t)}},"编辑",8,["onClick"]),[[C]]),d,Object(c["X"])(Object(c["n"])("a",{href:"javascript:;",onClick:function(n){return e.remove(t)}},"删除",8,["onClick"]),[[C]])]}))}]),1032,["columns","data-source"]),e.simple?Object(c["k"])("",!0):(Object(c["D"])(),Object(c["j"])(w,{key:1,style:{"margin-top":"24px"}},{default:a((function(){return[Object(c["n"])(_,{current:e.curPage,"onUpdate:current":t[4]||(t[4]=function(t){return e.curPage=t}),total:e.total,"page-size":10,onChange:e.setPage},null,8,["current","total","onChange"])]})),_:1}))]})),_:1},8,["title"]),Object(c["n"])(D,{show:e.show,"onUpdate:show":t[5]||(t[5]=function(t){return e.show=t}),classifyList:e.goodClassifyList,onGetList:e.getList},null,8,["show","classifyList","onGetList"]),Object(c["n"])(k,{show:e.showUpdateModal,"onUpdate:show":t[6]||(t[6]=function(t){return e.showUpdateModal=t}),good:e.curEditGood,onUpdate:e.updateCurGood},null,8,["show","good","onUpdate"])])})),O=n("1da1"),j=(n("7db0"),n("99af"),n("96cf"),n("8e44")),f=n("6c02"),p=n("f64c"),v=n("ed3b"),m=n("b558"),h=n("e428"),g=n("f2fa"),_=n("7e6c");n("b0c0");function w(e,t,n,a,r,u){var o=Object(c["L"])("a-input"),i=Object(c["L"])("a-form-item"),l=Object(c["L"])("a-input-number"),s=Object(c["L"])("a-date-picker"),d=Object(c["L"])("a-select-option"),b=Object(c["L"])("a-select"),O=Object(c["L"])("a-form"),j=Object(c["L"])("a-modal");return Object(c["D"])(),Object(c["j"])("div",null,[Object(c["n"])(j,{title:"添加".concat(e.$$.KEYWORD),visible:e.props.show,onOk:e.submit,onCancel:e.close},{default:Object(c["W"])((function(){return[Object(c["n"])(O,{"label-col":{span:6}},{default:Object(c["W"])((function(){return[Object(c["n"])(i,{label:"".concat(e.$$.KEYWORD,"名")},{default:Object(c["W"])((function(){return[Object(c["n"])(o,{value:e.addForm.name,"onUpdate:value":t[1]||(t[1]=function(t){return e.addForm.name=t})},null,8,["value"])]})),_:1},8,["label"]),Object(c["n"])(i,{label:"价格"},{default:Object(c["W"])((function(){return[Object(c["n"])(l,{value:e.addForm.price,"onUpdate:value":t[2]||(t[2]=function(t){return e.addForm.price=t}),min:0,max:99999999999},null,8,["value"])]})),_:1}),Object(c["n"])(i,{label:"保质期"},{default:Object(c["W"])((function(){return[Object(c["n"])(o,{value:e.addForm.expirationDate,"onUpdate:value":t[3]||(t[3]=function(t){return e.addForm.expirationDate=t})},null,8,["value"])]})),_:1}),Object(c["n"])(i,{label:"生产日期"},{default:Object(c["W"])((function(){return[Object(c["n"])(s,{value:e.addForm.producedDate,"onUpdate:value":t[4]||(t[4]=function(t){return e.addForm.producedDate=t})},null,8,["value"])]})),_:1}),Object(c["n"])(i,{label:"分类"},{default:Object(c["W"])((function(){return[Object(c["n"])(b,{value:e.addForm.classify,"onUpdate:value":t[5]||(t[5]=function(t){return e.addForm.classify=t}),style:{width:"120px"}},{default:Object(c["W"])((function(){return[(Object(c["D"])(!0),Object(c["j"])(c["b"],null,Object(c["J"])(e.store.goodClassify,(function(e){return Object(c["D"])(),Object(c["j"])(d,{key:e._id,value:e._id},{default:Object(c["W"])((function(){return[Object(c["m"])(Object(c["O"])(e.title),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]})),_:1}),Object(c["n"])(i,{label:"库存"},{default:Object(c["W"])((function(){return[Object(c["n"])(o,{value:e.addForm.count,"onUpdate:value":t[6]||(t[6]=function(t){return e.addForm.count=t})},null,8,["value"])]})),_:1})]})),_:1})]})),_:1},8,["title","visible","onOk","onCancel"])])}var y=n("4360"),D={name:"",price:0,producedDate:0,expirationDate:0,classify:"",count:""},k=Object(c["o"])({props:{show:Boolean},setup:function(e,t){var n=Object(c["H"])(Object(h["a"])(D));y["a"].state.goodClassify.length&&(n.classify=y["a"].state.goodClassify[0]._id);var a=function(){t.emit("update:show",!1)},r=function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(){var c,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=Object(h["a"])(n),c.producedDate=n.producedDate.valueOf(),e.next=4,j["d"].add(c);case 4:r=e.sent,Object(h["c"])(r).success((function(e,c){var r=c.data;Object.assign(n,D),p["a"].success(r.msg),t.emit("getList"),a()}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{addForm:n,submit:r,props:e,close:a,store:y["a"].state}}});k.render=w;var C=k,L=n("2366"),x=n("e0c4"),U=Object(c["o"])({components:{AddOne:C,Update:x["a"]},props:{simple:Boolean},setup:function(e){var t=Object(f["d"])(),n=[{title:"".concat(L["a"].KEYWORD,"名"),dataIndex:"name"},{title:"保质期",dataIndex:"expirationDate"},{title:"价格",dataIndex:"price"},{title:"库存",slots:{customRender:"count"}},{title:"生产日期",dataIndex:"producedDate",slots:{customRender:"producedDate"}},{title:"分类",slots:{customRender:"classify"}}];e.simple||n.push({title:"操作",slots:{customRender:"actions"}});var a=Object(c["I"])(!1),r=Object(c["I"])(!1),u=Object(c["I"])([]),o=Object(c["I"])(0),i=Object(c["I"])(1),l=Object(c["I"])(""),s=Object(c["I"])(!1),d=Object(c["I"])({}),b=function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j["d"].list({page:i.value,size:10,keyword:l.value});case 2:t=e.sent,Object(h["c"])(t).success((function(e){var t=e.data,n=t.list,c=t.total;u.value=n,o.value=c}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c["A"])(Object(O["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:b();case 1:case"end":return e.stop()}}),e)}))));var w=function(e){i.value=e,b()},y=function(){b(),s.value=Boolean(l.value)},D=function(){l.value="",s.value=!1,b()},k=function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(t){var n,c,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.text,c=n._id,e.next=4,j["d"].remove(c);case 4:a=e.sent,Object(h["c"])(a).success((function(e){var t=e.msg;p["a"].success(t),b()}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t){var n="增加";"OUT_COUNT"===e&&(n="减少"),v["a"].confirm({title:"要".concat(n,"多少库存"),content:Object(c["n"])("div",null,[Object(c["n"])(m["a"],{class:"__good_input_count"},null)]),onOk:function(){var c=Object(O["a"])(regeneratorRuntime.mark((function c(){var a,r,o;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return a=document.querySelector(".__good_input_count"),r=a.value,c.next=4,j["d"].updateCount({id:t._id,num:r,type:e});case 4:o=c.sent,Object(h["c"])(o).success((function(c){r="IN_COUNT"===e?Math.abs(r):-Math.abs(r);var a=u.value.find((function(e){return e._id===t._id}));a&&(console.log(r),a.count=a.count+r,p["a"].success("成功".concat(n," ").concat(Math.abs(r)," 本书")))}));case 6:case"end":return c.stop()}}),c)})));function a(){return c.apply(this,arguments)}return a}()})},x=function(e){var t=e.record;r.value=!0,curEditgood.value=t},U=function(e){Object.assign(curEditgood.value,e)},R=function(e){var n=e.record;t.push("/goods/".concat(n._id))},F=function(e){var t=e.file;t.response&&Object(h["c"])(t.response).success(function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j["d"].addMany(t);case 2:n=e.sent,Object(h["c"])(n).success((function(e){var t=e.data.addCount;p["a"].success("成功添加 ".concat(t," 本书")),b()}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return{columns:n,show:a,list:u,formatTimestamp:h["b"],curPage:i,total:o,setPage:w,keyword:l,onSearch:y,backAll:D,isSearch:s,remove:k,updateCount:C,showUpdateModal:r,update:x,curEditGood:d,updateCurGood:U,toDetail:R,getList:b,getClassifyTitleById:_["a"],simple:e.simple,onUploadChange:F,headers:Object(g["c"])()}}});n("3db2");U.render=b,U.__scopeId="data-v-464bc92e";t["default"]=U},e0c4:function(e,t,n){"use strict";n("b0c0");var c=n("7a23");function a(e,t,n,a,r,u){var o=Object(c["L"])("a-input"),i=Object(c["L"])("a-form-item"),l=Object(c["L"])("a-input-number"),s=Object(c["L"])("a-date-picker"),d=Object(c["L"])("a-select-option"),b=Object(c["L"])("a-select"),O=Object(c["L"])("a-form"),j=Object(c["L"])("a-modal");return Object(c["D"])(),Object(c["j"])("div",null,[Object(c["n"])(j,{title:"修改".concat(e.$$.KEYWORD),visible:e.props.show,onOk:e.submit,onCancel:e.close},{default:Object(c["W"])((function(){return[Object(c["n"])(O,{"label-col":{span:6}},{default:Object(c["W"])((function(){return[Object(c["n"])(i,{label:"".concat(e.$$.KEYWORD,"名")},{default:Object(c["W"])((function(){return[Object(c["n"])(o,{value:e.editForm.name,"onUpdate:value":t[1]||(t[1]=function(t){return e.editForm.name=t})},null,8,["value"])]})),_:1},8,["label"]),Object(c["n"])(i,{label:"价格"},{default:Object(c["W"])((function(){return[Object(c["n"])(l,{value:e.editForm.price,"onUpdate:value":t[2]||(t[2]=function(t){return e.editForm.price=t}),min:0,max:99999999999},null,8,["value"])]})),_:1}),Object(c["n"])(i,{label:"保质期"},{default:Object(c["W"])((function(){return[Object(c["n"])(o,{value:e.editForm.expirationDate,"onUpdate:value":t[3]||(t[3]=function(t){return e.editForm.expirationDate=t})},null,8,["value"])]})),_:1}),Object(c["n"])(i,{label:"生产日期"},{default:Object(c["W"])((function(){return[Object(c["n"])(s,{value:e.editForm.producedDate,"onUpdate:value":t[4]||(t[4]=function(t){return e.editForm.producedDate=t})},null,8,["value"])]})),_:1}),Object(c["n"])(i,{label:"分类"},{default:Object(c["W"])((function(){return[Object(c["n"])(b,{value:e.editForm.classify,"onUpdate:value":t[5]||(t[5]=function(t){return e.editForm.classify=t}),style:{width:"120px"}},{default:Object(c["W"])((function(){return[(Object(c["D"])(!0),Object(c["j"])(c["b"],null,Object(c["J"])(e.store.goodClassify,(function(e){return Object(c["D"])(),Object(c["j"])(d,{key:e._id,value:e._id},{default:Object(c["W"])((function(){return[Object(c["m"])(Object(c["O"])(e.title),1)]})),_:2},1032,["value"])})),128))]})),_:1},8,["value"])]})),_:1})]})),_:1})]})),_:1},8,["title","visible","onOk","onCancel"])])}var r=n("1da1"),u=(n("96cf"),n("a9e3"),n("8e44")),o=n("f64c"),i=n("e428"),l=n("c1df"),s=n.n(l),d=n("4360"),b=Object(c["o"])({props:{show:Boolean,good:Object},setup:function(e,t){var n=Object(c["H"])({name:"",price:0,producedDate:"",expirationDate:0,classify:""}),a=function(){t.emit("update:show",!1)};Object(c["U"])((function(){return e.good}),(function(e){Object.assign(n,e),n.producedDate=s()(Number(n.producedDate))}));var l=function(){var c=Object(r["a"])(regeneratorRuntime.mark((function c(){var r;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:return c.next=2,u["d"].update({id:e.good._id,name:n.name,price:n.price,expirationDate:n.expirationDate,producedDate:n.producedDate.valueOf(),classify:n.classify});case 2:r=c.sent,Object(i["c"])(r).success((function(e){var n=e.data,c=e.msg;t.emit("update",n),o["a"].success(c),a()}));case 4:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();return{editForm:n,submit:l,props:e,close:a,store:d["a"].state}}});b.render=a;t["a"]=b}}]);
//# sourceMappingURL=Goods.716a968b.js.map